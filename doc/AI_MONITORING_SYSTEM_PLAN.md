# AI ìƒë‹´ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ ì™„ë²½ êµ¬í˜„ ê³„íšì„œ

> **ì‘ì„±ì¼:** 2025-12-08
> **ëª©í‘œ:** AI ìƒë‹´ í•µì‹¬ ê¸°ëŠ¥ì˜ ì™„ë²½í•œ ê´€ì°°, ë¶„ì„, ìµœì í™” ì‹œìŠ¤í…œ êµ¬ì¶•

---

## ğŸ“‹ ëª©ì°¨

1. [ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ ê°œìš”](#1-ëª¨ë‹ˆí„°ë§-ì‹œìŠ¤í…œ-ê°œìš”)
2. [ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„](#2-ë°ì´í„°ë² ì´ìŠ¤-ì„¤ê³„)
3. [ìˆ˜ì§‘ ë°ì´í„° ì •ì˜](#3-ìˆ˜ì§‘-ë°ì´í„°-ì •ì˜)
4. [ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§](#4-ì‹¤ì‹œê°„-ëª¨ë‹ˆí„°ë§)
5. [ëŒ€ì‹œë³´ë“œ ì‹œìŠ¤í…œ](#5-ëŒ€ì‹œë³´ë“œ-ì‹œìŠ¤í…œ)
6. [ì•Œë¦¼ ì‹œìŠ¤í…œ](#6-ì•Œë¦¼-ì‹œìŠ¤í…œ)
7. [ë¶„ì„ ë° ë¦¬í¬íŠ¸](#7-ë¶„ì„-ë°-ë¦¬í¬íŠ¸)
8. [êµ¬í˜„ ìš°ì„ ìˆœìœ„](#8-êµ¬í˜„-ìš°ì„ ìˆœìœ„)

---

## 1. ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ ê°œìš”

### 1.1 ëª©ì 

```
í•µì‹¬ ê¸°ëŠ¥ì¸ AI ìƒë‹´ì„:
1. ì‹¤ì‹œê°„ìœ¼ë¡œ ê´€ì°° (ë¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚˜ëŠ”ê°€?)
2. ì„±ëŠ¥ ì¸¡ì • (ì–¼ë§ˆë‚˜ ë¹ ë¥¸ê°€? ë¹„ìš©ì€?)
3. í’ˆì§ˆ ë³´ì¦ (ì •í™•í•œê°€? ë§Œì¡±ìŠ¤ëŸ¬ìš´ê°€?)
4. ë¬¸ì œ ê°ì§€ (ì˜¤ë¥˜ëŠ” ì—†ëŠ”ê°€?)
5. ì§€ì† ê°œì„  (ì–´ë–»ê²Œ ë” ì¢‹ê²Œ ë§Œë“¤ ìˆ˜ ìˆëŠ”ê°€?)
```

### 1.2 ëª¨ë‹ˆí„°ë§ ë²”ìœ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           ì‚¬ìš©ì ì§ˆë¬¸                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  ğŸ“Š ë©”íŠ¸ë¦­ ìˆ˜ì§‘  â”‚ â† ì‹œì‘
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  ì§ˆë¬¸ ë¶„ì„       â”‚ â† complexity, history tier
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  AI #1 í˜¸ì¶œ      â”‚ â† ì‹œê°„, í† í°, ë„êµ¬ ì‚¬ìš©
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  AI #2 í˜¸ì¶œ      â”‚ â† ì‹œê°„, í† í°
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  ë‹µë³€ ë°˜í™˜       â”‚ â† ì „ì²´ ì‹œê°„, ì„±ê³µ ì—¬ë¶€
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  ğŸ’¾ DB ì €ì¥      â”‚ â† ì˜êµ¬ ì €ì¥
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  ğŸš¨ ì•Œë¦¼ ì²´í¬    â”‚ â† ì´ìƒ ì§•í›„ ê°ì§€
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  ğŸ“ˆ ëŒ€ì‹œë³´ë“œ     â”‚ â† ì‹¤ì‹œê°„ ì‹œê°í™”
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„

### 2.1 ChatMetrics ëª¨ë¸

```prisma
// prisma/schema.prisma

model ChatMetrics {
  id        String   @id @default(cuid())
  createdAt DateTime @default(now())

  // ============================================================
  // ê¸°ë³¸ ì •ë³´
  // ============================================================
  babyId    String // ì•„ê¸° ID
  userId    String // ì‚¬ìš©ì ID
  question  String @db.Text // ì‚¬ìš©ì ì§ˆë¬¸ (ì›ë³¸)
  answer    String @db.Text // AI ë‹µë³€ (ì›ë³¸)

  // ============================================================
  // ë¶„ë¥˜ ì •ë³´
  // ============================================================
  complexity      String // "simple" | "complex"
  historyTier     Int    // 1 | 2 | 3
  historyCount    Int    // ì‹¤ì œ í¬í•¨ëœ ëŒ€í™” ê°œìˆ˜
  historyReason   String // íŒë‹¨ ì´ìœ 
  mode            String // "single-ai" | "dual-ai"

  // ============================================================
  // ì„±ëŠ¥ ì§€í‘œ
  // ============================================================
  totalTime         Int // ì „ì²´ ì‘ë‹µ ì‹œê°„ (ms)
  orchestratorTime  Int? // AI #1 ì‹¤í–‰ ì‹œê°„ (ms)
  answererTime      Int? // AI #2 ì‹¤í–‰ ì‹œê°„ (ms)
  toolsTime         Int? // ë„êµ¬ ì‹¤í–‰ ì‹œê°„ (ms)
  databaseTime      Int? // DB ì¿¼ë¦¬ ì‹œê°„ (ms)

  // ============================================================
  // ë¹„ìš© ì§€í‘œ
  // ============================================================
  inputTokens       Int // ì…ë ¥ í† í°
  outputTokens      Int // ì¶œë ¥ í† í°
  totalTokens       Int // ì´ í† í°
  estimatedCost     Float // ì˜ˆìƒ ë¹„ìš© (USD)
  aiCallCount       Int // AI í˜¸ì¶œ íšŸìˆ˜ (1 or 2)

  // ============================================================
  // ë„êµ¬ ì‚¬ìš©
  // ============================================================
  toolsCalled       String[] // í˜¸ì¶œëœ ë„êµ¬ ëª©ë¡
  toolsSuccess      Boolean // ëª¨ë“  ë„êµ¬ ì„±ê³µ ì—¬ë¶€
  toolsData         Json? // ë„êµ¬ ìƒì„¸ ë°ì´í„° (ì„ íƒ)

  // ============================================================
  // ê²°ê³¼ ë° í’ˆì§ˆ
  // ============================================================
  success           Boolean // ì „ì²´ ì„±ê³µ ì—¬ë¶€
  errorType         String? // ì˜¤ë¥˜ ìœ í˜• (ìˆëŠ” ê²½ìš°)
  errorMessage      String? @db.Text // ì˜¤ë¥˜ ë©”ì‹œì§€

  dataAvailable     Boolean // ë°ì´í„° ì¡´ì¬ ì—¬ë¶€
  missingInfo       String[] // ë¶€ì¡±í•œ ì •ë³´ ëª©ë¡

  // ============================================================
  // ì‚¬ìš©ì í”¼ë“œë°±
  // ============================================================
  userFeedback      Json? // { helpful: boolean, comment?: string }
  feedbackAt        DateTime? // í”¼ë“œë°± ì‹œê°„

  // ============================================================
  // ê´€ê³„
  // ============================================================
  Baby Baby @relation(fields: [babyId], references: [id], onDelete: Cascade)
  User User @relation(fields: [userId], references: [id], onDelete: Cascade)

  // ============================================================
  // ì¸ë±ìŠ¤ (ì¿¼ë¦¬ ìµœì í™”)
  // ============================================================
  @@index([babyId, createdAt(sort: Desc)])
  @@index([userId, createdAt(sort: Desc)])
  @@index([createdAt(sort: Desc)])
  @@index([complexity])
  @@index([success])
}
```

### 2.2 MetricsAlert ëª¨ë¸ (ì•Œë¦¼ ê´€ë¦¬)

```prisma
model MetricsAlert {
  id        String   @id @default(cuid())
  createdAt DateTime @default(now())

  // ì•Œë¦¼ ìœ í˜•
  type      String // "budget_exceeded" | "slow_response" | "high_error_rate" | "low_satisfaction"
  severity  String // "info" | "warning" | "critical"

  // ì•Œë¦¼ ë‚´ìš©
  title     String
  message   String @db.Text

  // ê´€ë ¨ ë°ì´í„°
  metadata  Json // { cost: 250, threshold: 200 }

  // ìƒíƒœ
  resolved  Boolean @default(false)
  resolvedAt DateTime?

  @@index([createdAt(sort: Desc)])
  @@index([type])
  @@index([resolved])
}
```

### 2.3 DailyMetricsSummary ëª¨ë¸ (ì¼ì¼ ìš”ì•½)

```prisma
model DailyMetricsSummary {
  id   String   @id @default(cuid())
  date DateTime @unique // ë‚ ì§œ (YYYY-MM-DD)

  // ì§ˆë¬¸ í†µê³„
  totalQuestions     Int
  simpleQuestions    Int
  complexQuestions   Int

  // ëŒ€í™” ê¸°ë¡ ì‚¬ìš©
  tier1Count         Int
  tier2Count         Int
  tier3Count         Int

  // ì„±ëŠ¥
  avgResponseTime    Float // í‰ê·  ì‘ë‹µ ì‹œê°„ (ms)
  minResponseTime    Int
  maxResponseTime    Int

  // ë¹„ìš©
  totalTokens        Int
  totalCost          Float // USD
  avgCostPerQuestion Float

  // í’ˆì§ˆ
  successRate        Float // ì„±ê³µë¥  (%)
  errorCount         Int

  // ì‚¬ìš©ì í”¼ë“œë°±
  feedbackCount      Int
  helpfulCount       Int
  satisfactionRate   Float? // ë§Œì¡±ë„ (%)

  // ìì£¼ ì‚¬ìš©ëœ ë„êµ¬
  topTools           Json // { "calculateStats": 150, "getActivityLogs": 80, ... }

  // ìì£¼ ë¬»ëŠ” ì§ˆë¬¸
  topQuestions       Json // [ { question: "ì˜¤ëŠ˜ ìˆ˜ìœ  ëª‡ ë²ˆ?", count: 45 }, ... ]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([date(sort: Desc)])
}
```

---

## 3. ìˆ˜ì§‘ ë°ì´í„° ì •ì˜

### 3.1 ë©”íŠ¸ë¦­ ìˆ˜ì§‘ ì„œë¹„ìŠ¤

```typescript
// src/features/ai-chat/services/metricsCollector.ts

import { prisma } from "@/shared/lib/prisma";

export interface ChatMetricsInput {
  // ê¸°ë³¸ ì •ë³´
  babyId: string;
  userId: string;
  question: string;
  answer: string;

  // ë¶„ë¥˜
  complexity: "simple" | "complex";
  historyTier: 1 | 2 | 3;
  historyCount: number;
  historyReason: string;
  mode: "single-ai" | "dual-ai";

  // ì„±ëŠ¥ (íƒ€ì„ìŠ¤íƒ¬í”„ë¡œ ìë™ ê³„ì‚°)
  startTime: number;
  orchestratorStartTime?: number;
  orchestratorEndTime?: number;
  answererStartTime?: number;
  answererEndTime?: number;
  toolsStartTime?: number;
  toolsEndTime?: number;
  databaseStartTime?: number;
  databaseEndTime?: number;
  endTime: number;

  // ë¹„ìš©
  inputTokens: number;
  outputTokens: number;
  aiCallCount: number;

  // ë„êµ¬ ì‚¬ìš©
  toolsCalled: string[];
  toolsSuccess: boolean;
  toolsData?: any;

  // ê²°ê³¼
  success: boolean;
  errorType?: string;
  errorMessage?: string;
  dataAvailable: boolean;
  missingInfo?: string[];
}

/**
 * AI ìƒë‹´ ë©”íŠ¸ë¦­ ìˆ˜ì§‘ ë° ì €ì¥
 */
export async function collectChatMetrics(
  input: ChatMetricsInput
): Promise<void> {
  try {
    // 1. ì‹œê°„ ê³„ì‚°
    const totalTime = input.endTime - input.startTime;
    const orchestratorTime = input.orchestratorEndTime && input.orchestratorStartTime
      ? input.orchestratorEndTime - input.orchestratorStartTime
      : null;
    const answererTime = input.answererEndTime && input.answererStartTime
      ? input.answererEndTime - input.answererStartTime
      : null;
    const toolsTime = input.toolsEndTime && input.toolsStartTime
      ? input.toolsEndTime - input.toolsStartTime
      : null;
    const databaseTime = input.databaseEndTime && input.databaseStartTime
      ? input.databaseEndTime - input.databaseStartTime
      : null;

    // 2. í† í° ê³„ì‚°
    const totalTokens = input.inputTokens + input.outputTokens;

    // 3. ë¹„ìš© ê³„ì‚° (Gemini 2.0 Flash ê¸°ì¤€)
    const inputCost = (input.inputTokens / 1000) * 0.00001; // $0.01 per 1M tokens
    const outputCost = (input.outputTokens / 1000) * 0.00003; // $0.03 per 1M tokens
    const estimatedCost = inputCost + outputCost;

    // 4. DB ì €ì¥
    await prisma.chatMetrics.create({
      data: {
        babyId: input.babyId,
        userId: input.userId,
        question: input.question,
        answer: input.answer,

        complexity: input.complexity,
        historyTier: input.historyTier,
        historyCount: input.historyCount,
        historyReason: input.historyReason,
        mode: input.mode,

        totalTime,
        orchestratorTime,
        answererTime,
        toolsTime,
        databaseTime,

        inputTokens: input.inputTokens,
        outputTokens: input.outputTokens,
        totalTokens,
        estimatedCost,
        aiCallCount: input.aiCallCount,

        toolsCalled: input.toolsCalled,
        toolsSuccess: input.toolsSuccess,
        toolsData: input.toolsData,

        success: input.success,
        errorType: input.errorType,
        errorMessage: input.errorMessage,
        dataAvailable: input.dataAvailable,
        missingInfo: input.missingInfo || [],
      },
    });

    // 5. ì‹¤ì‹œê°„ ë¡œê·¸
    console.log("ğŸ“Š Metrics Collected:", {
      question: input.question.slice(0, 30),
      time: `${totalTime}ms`,
      cost: `$${estimatedCost.toFixed(6)}`,
      tokens: totalTokens,
      mode: input.mode,
      tier: input.historyTier,
    });

    // 6. ì•Œë¦¼ ì²´í¬ (ë¹„ë™ê¸°)
    checkAlertsAsync(input, totalTime, estimatedCost).catch(console.error);

  } catch (error) {
    console.error("âŒ Metrics Collection Failed:", error);
    // ë©”íŠ¸ë¦­ ìˆ˜ì§‘ ì‹¤íŒ¨ëŠ” ì‚¬ìš©ìì—ê²Œ ì˜í–¥ ì£¼ë©´ ì•ˆ ë¨
  }
}

/**
 * ì•Œë¦¼ ì²´í¬ (ë¹„ë™ê¸°)
 */
async function checkAlertsAsync(
  input: ChatMetricsInput,
  totalTime: number,
  cost: number
): Promise<void> {
  // ì‘ë‹µ ì‹œê°„ ê²½ê³  (5ì´ˆ ì´ìƒ)
  if (totalTime > 5000) {
    await createAlert({
      type: "slow_response",
      severity: "warning",
      title: "ëŠë¦° ì‘ë‹µ ê°ì§€",
      message: `ì‘ë‹µ ì‹œê°„ ${totalTime}ms (5ì´ˆ ì´ˆê³¼)`,
      metadata: { totalTime, question: input.question },
    });
  }

  // ì˜¤ë¥˜ ë°œìƒ
  if (!input.success) {
    await createAlert({
      type: "ai_error",
      severity: "critical",
      title: "AI ìƒë‹´ ì˜¤ë¥˜ ë°œìƒ",
      message: input.errorMessage || "ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜",
      metadata: { errorType: input.errorType, question: input.question },
    });
  }

  // ì¼ì¼ ì˜ˆì‚° ì²´í¬
  const todayCost = await getTodayCost();
  if (todayCost > 10) { // $10/ì¼ ê¸°ì¤€
    await createAlert({
      type: "budget_exceeded",
      severity: "warning",
      title: "ì¼ì¼ ì˜ˆì‚° ì´ˆê³¼",
      message: `ì˜¤ëŠ˜ ë¹„ìš© $${todayCost.toFixed(2)} (í•œë„: $10)`,
      metadata: { todayCost, threshold: 10 },
    });
  }
}

/**
 * ì•Œë¦¼ ìƒì„±
 */
async function createAlert(alert: {
  type: string;
  severity: string;
  title: string;
  message: string;
  metadata: any;
}): Promise<void> {
  await prisma.metricsAlert.create({
    data: alert,
  });

  console.log(`ğŸš¨ Alert Created [${alert.severity}]: ${alert.title}`);
}

/**
 * ì˜¤ëŠ˜ ì´ ë¹„ìš© ì¡°íšŒ
 */
async function getTodayCost(): Promise<number> {
  const today = new Date();
  today.setHours(0, 0, 0, 0);

  const result = await prisma.chatMetrics.aggregate({
    where: {
      createdAt: { gte: today },
    },
    _sum: {
      estimatedCost: true,
    },
  });

  return result._sum.estimatedCost || 0;
}
```

### 3.2 í† í° ê³„ì‚° ìœ í‹¸ë¦¬í‹°

```typescript
// src/features/ai-chat/utils/tokenCounter.ts

/**
 * í…ìŠ¤íŠ¸ì˜ ëŒ€ëµì ì¸ í† í° ìˆ˜ ê³„ì‚°
 * (ì •í™•í•œ ê³„ì‚°ì€ tiktoken ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš© í•„ìš”)
 */
export function estimateTokens(text: string): number {
  // ê°„ë‹¨í•œ ì¶”ì •: 1 í† í° â‰ˆ 4 ê¸€ì (í•œê¸€ ê¸°ì¤€)
  // ì˜ì–´ëŠ” 1 í† í° â‰ˆ 4 ë¬¸ì
  return Math.ceil(text.length / 3);
}

/**
 * í”„ë¡¬í”„íŠ¸ í† í° ê³„ì‚°
 */
export function calculatePromptTokens(
  systemPrompt: string,
  userMessage: string,
  chatHistory: string = ""
): number {
  return (
    estimateTokens(systemPrompt) +
    estimateTokens(userMessage) +
    estimateTokens(chatHistory)
  );
}

/**
 * ì‘ë‹µ í† í° ê³„ì‚°
 */
export function calculateResponseTokens(response: string): number {
  return estimateTokens(response);
}
```

---

## 4. ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§

### 4.1 ì‹¤ì‹œê°„ í†µê³„ API

```typescript
// src/app/api/admin/metrics/realtime/route.ts

import { NextResponse } from "next/server";
import { prisma } from "@/shared/lib/prisma";

export async function GET() {
  try {
    // ìµœê·¼ 5ë¶„ê°„ í†µê³„
    const fiveMinutesAgo = new Date(Date.now() - 5 * 60 * 1000);

    const recentMetrics = await prisma.chatMetrics.findMany({
      where: {
        createdAt: { gte: fiveMinutesAgo },
      },
      orderBy: { createdAt: "desc" },
    });

    // ì˜¤ëŠ˜ í†µê³„
    const todayStart = new Date();
    todayStart.setHours(0, 0, 0, 0);

    const todayMetrics = await prisma.chatMetrics.findMany({
      where: {
        createdAt: { gte: todayStart },
      },
    });

    // ì‹¤ì‹œê°„ í†µê³„ ê³„ì‚°
    const stats = {
      // ìµœê·¼ 5ë¶„
      recent: {
        count: recentMetrics.length,
        avgTime: average(recentMetrics.map(m => m.totalTime)),
        errorCount: recentMetrics.filter(m => !m.success).length,
        totalCost: sum(recentMetrics.map(m => m.estimatedCost)),
      },

      // ì˜¤ëŠ˜
      today: {
        count: todayMetrics.length,
        avgTime: average(todayMetrics.map(m => m.totalTime)),
        errorRate: (todayMetrics.filter(m => !m.success).length / todayMetrics.length) * 100,
        totalCost: sum(todayMetrics.map(m => m.estimatedCost)),

        // ë¶„ë¥˜ë³„
        simple: todayMetrics.filter(m => m.complexity === "simple").length,
        complex: todayMetrics.filter(m => m.complexity === "complex").length,

        // ëŒ€í™” ê¸°ë¡
        tier1: todayMetrics.filter(m => m.historyTier === 1).length,
        tier2: todayMetrics.filter(m => m.historyTier === 2).length,
        tier3: todayMetrics.filter(m => m.historyTier === 3).length,
      },

      // ìµœê·¼ ì•Œë¦¼
      alerts: await prisma.metricsAlert.findMany({
        where: { resolved: false },
        orderBy: { createdAt: "desc" },
        take: 5,
      }),
    };

    return NextResponse.json(stats);
  } catch (error) {
    console.error("Realtime metrics error:", error);
    return NextResponse.json({ error: "Failed to fetch metrics" }, { status: 500 });
  }
}

// ìœ í‹¸ë¦¬í‹°
function average(numbers: number[]): number {
  if (numbers.length === 0) return 0;
  return numbers.reduce((a, b) => a + b, 0) / numbers.length;
}

function sum(numbers: number[]): number {
  return numbers.reduce((a, b) => a + b, 0);
}
```

---

## 5. ëŒ€ì‹œë³´ë“œ ì‹œìŠ¤í…œ

### 5.1 ëŒ€ì‹œë³´ë“œ ì»´í¬ë„ŒíŠ¸

```typescript
// src/app/admin/metrics/page.tsx

"use client";

import { useEffect, useState } from "react";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Alert, AlertDescription } from "@/components/ui/alert";

interface RealtimeStats {
  recent: {
    count: number;
    avgTime: number;
    errorCount: number;
    totalCost: number;
  };
  today: {
    count: number;
    avgTime: number;
    errorRate: number;
    totalCost: number;
    simple: number;
    complex: number;
    tier1: number;
    tier2: number;
    tier3: number;
  };
  alerts: Array<{
    id: string;
    type: string;
    severity: string;
    title: string;
    message: string;
    createdAt: Date;
  }>;
}

export default function MetricsDashboard() {
  const [stats, setStats] = useState<RealtimeStats | null>(null);
  const [loading, setLoading] = useState(true);

  // 5ì´ˆë§ˆë‹¤ ìë™ ê°±ì‹ 
  useEffect(() => {
    const fetchStats = async () => {
      try {
        const res = await fetch("/api/admin/metrics/realtime");
        const data = await res.json();
        setStats(data);
        setLoading(false);
      } catch (error) {
        console.error("Failed to fetch stats:", error);
      }
    };

    fetchStats();
    const interval = setInterval(fetchStats, 5000);

    return () => clearInterval(interval);
  }, []);

  if (loading) return <div>ë¡œë”© ì¤‘...</div>;
  if (!stats) return <div>ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>;

  return (
    <div className="p-8 space-y-6">
      <h1 className="text-3xl font-bold">AI ìƒë‹´ ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ</h1>

      {/* ì•Œë¦¼ */}
      {stats.alerts.length > 0 && (
        <div className="space-y-2">
          <h2 className="text-xl font-semibold">ğŸš¨ í™œì„± ì•Œë¦¼</h2>
          {stats.alerts.map((alert) => (
            <Alert
              key={alert.id}
              variant={alert.severity === "critical" ? "destructive" : "default"}
            >
              <AlertDescription>
                <strong>{alert.title}</strong>: {alert.message}
              </AlertDescription>
            </Alert>
          ))}
        </div>
      )}

      {/* ì‹¤ì‹œê°„ í†µê³„ (ìµœê·¼ 5ë¶„) */}
      <div>
        <h2 className="text-xl font-semibold mb-4">âš¡ ì‹¤ì‹œê°„ (ìµœê·¼ 5ë¶„)</h2>
        <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
          <Card>
            <CardHeader>
              <CardTitle>ì§ˆë¬¸ ìˆ˜</CardTitle>
            </CardHeader>
            <CardContent>
              <p className="text-3xl font-bold">{stats.recent.count}</p>
            </CardContent>
          </Card>

          <Card>
            <CardHeader>
              <CardTitle>í‰ê·  ì‘ë‹µ ì‹œê°„</CardTitle>
            </CardHeader>
            <CardContent>
              <p className="text-3xl font-bold">
                {stats.recent.avgTime.toFixed(0)}ms
              </p>
            </CardContent>
          </Card>

          <Card>
            <CardHeader>
              <CardTitle>ì˜¤ë¥˜ ìˆ˜</CardTitle>
            </CardHeader>
            <CardContent>
              <p className="text-3xl font-bold text-red-600">
                {stats.recent.errorCount}
              </p>
            </CardContent>
          </Card>

          <Card>
            <CardHeader>
              <CardTitle>ë¹„ìš©</CardTitle>
            </CardHeader>
            <CardContent>
              <p className="text-3xl font-bold">
                ${stats.recent.totalCost.toFixed(4)}
              </p>
            </CardContent>
          </Card>
        </div>
      </div>

      {/* ì˜¤ëŠ˜ í†µê³„ */}
      <div>
        <h2 className="text-xl font-semibold mb-4">ğŸ“Š ì˜¤ëŠ˜</h2>
        <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
          <Card>
            <CardHeader>
              <CardTitle>ì´ ì§ˆë¬¸</CardTitle>
            </CardHeader>
            <CardContent>
              <p className="text-3xl font-bold">{stats.today.count}</p>
              <p className="text-sm text-gray-500">
                Simple: {stats.today.simple} | Complex: {stats.today.complex}
              </p>
            </CardContent>
          </Card>

          <Card>
            <CardHeader>
              <CardTitle>í‰ê·  ì‘ë‹µ ì‹œê°„</CardTitle>
            </CardHeader>
            <CardContent>
              <p className="text-3xl font-bold">
                {stats.today.avgTime.toFixed(0)}ms
              </p>
            </CardContent>
          </Card>

          <Card>
            <CardHeader>
              <CardTitle>ì˜¤ë¥˜ìœ¨</CardTitle>
            </CardHeader>
            <CardContent>
              <p className="text-3xl font-bold">
                {stats.today.errorRate.toFixed(1)}%
              </p>
            </CardContent>
          </Card>

          <Card>
            <CardHeader>
              <CardTitle>ì´ ë¹„ìš©</CardTitle>
            </CardHeader>
            <CardContent>
              <p className="text-3xl font-bold">
                ${stats.today.totalCost.toFixed(2)}
              </p>
            </CardContent>
          </Card>
        </div>
      </div>

      {/* ëŒ€í™” ê¸°ë¡ ì‚¬ìš© ë¶„í¬ */}
      <div>
        <h2 className="text-xl font-semibold mb-4">ğŸ’¬ ëŒ€í™” ê¸°ë¡ ì‚¬ìš©</h2>
        <Card>
          <CardContent className="pt-6">
            <div className="space-y-4">
              <div>
                <div className="flex justify-between mb-2">
                  <span>Tier 1 (0ê°œ)</span>
                  <span>{stats.today.tier1}íšŒ</span>
                </div>
                <div className="w-full bg-gray-200 rounded-full h-4">
                  <div
                    className="bg-blue-500 h-4 rounded-full"
                    style={{
                      width: `${(stats.today.tier1 / stats.today.count) * 100}%`,
                    }}
                  />
                </div>
              </div>

              <div>
                <div className="flex justify-between mb-2">
                  <span>Tier 2 (2ê°œ)</span>
                  <span>{stats.today.tier2}íšŒ</span>
                </div>
                <div className="w-full bg-gray-200 rounded-full h-4">
                  <div
                    className="bg-green-500 h-4 rounded-full"
                    style={{
                      width: `${(stats.today.tier2 / stats.today.count) * 100}%`,
                    }}
                  />
                </div>
              </div>

              <div>
                <div className="flex justify-between mb-2">
                  <span>Tier 3 (3ê°œ)</span>
                  <span>{stats.today.tier3}íšŒ</span>
                </div>
                <div className="w-full bg-gray-200 rounded-full h-4">
                  <div
                    className="bg-yellow-500 h-4 rounded-full"
                    style={{
                      width: `${(stats.today.tier3 / stats.today.count) * 100}%`,
                    }}
                  />
                </div>
              </div>
            </div>
          </CardContent>
        </Card>
      </div>
    </div>
  );
}
```

---

## 6. ì•Œë¦¼ ì‹œìŠ¤í…œ

### 6.1 ì•Œë¦¼ ê·œì¹™

```typescript
// src/features/ai-chat/services/alertRules.ts

export interface AlertRule {
  name: string;
  type: string;
  severity: "info" | "warning" | "critical";
  condition: (metrics: any) => boolean;
  getMessage: (metrics: any) => string;
}

export const ALERT_RULES: AlertRule[] = [
  // 1. ì‘ë‹µ ì‹œê°„ ê²½ê³ 
  {
    name: "ëŠë¦° ì‘ë‹µ",
    type: "slow_response",
    severity: "warning",
    condition: (m) => m.totalTime > 5000,
    getMessage: (m) => `ì‘ë‹µ ì‹œê°„ ${m.totalTime}ms (5ì´ˆ ì´ˆê³¼)`,
  },

  // 2. ì‘ë‹µ ì‹œê°„ ì‹¬ê°
  {
    name: "ë§¤ìš° ëŠë¦° ì‘ë‹µ",
    type: "very_slow_response",
    severity: "critical",
    condition: (m) => m.totalTime > 10000,
    getMessage: (m) => `ì‘ë‹µ ì‹œê°„ ${m.totalTime}ms (10ì´ˆ ì´ˆê³¼!)`,
  },

  // 3. AI ì˜¤ë¥˜
  {
    name: "AI ì˜¤ë¥˜",
    type: "ai_error",
    severity: "critical",
    condition: (m) => !m.success,
    getMessage: (m) => `AI ì˜¤ë¥˜: ${m.errorMessage}`,
  },

  // 4. ë„êµ¬ ì‹¤íŒ¨
  {
    name: "ë„êµ¬ ì‹¤í–‰ ì‹¤íŒ¨",
    type: "tool_failure",
    severity: "warning",
    condition: (m) => !m.toolsSuccess && m.toolsCalled.length > 0,
    getMessage: (m) => `ë„êµ¬ ì‹¤í–‰ ì‹¤íŒ¨: ${m.toolsCalled.join(", ")}`,
  },

  // 5. ì¼ì¼ ì˜ˆì‚° 80% ì´ˆê³¼
  {
    name: "ì˜ˆì‚° ê²½ê³ ",
    type: "budget_warning",
    severity: "warning",
    condition: async () => {
      const todayCost = await getTodayCost();
      return todayCost > 8; // $10ì˜ 80%
    },
    getMessage: async () => {
      const cost = await getTodayCost();
      return `ì¼ì¼ ì˜ˆì‚° 80% ì´ˆê³¼: $${cost.toFixed(2)} / $10`;
    },
  },

  // 6. ì¼ì¼ ì˜ˆì‚° ì´ˆê³¼
  {
    name: "ì˜ˆì‚° ì´ˆê³¼",
    type: "budget_exceeded",
    severity: "critical",
    condition: async () => {
      const todayCost = await getTodayCost();
      return todayCost > 10;
    },
    getMessage: async () => {
      const cost = await getTodayCost();
      return `ì¼ì¼ ì˜ˆì‚° ì´ˆê³¼: $${cost.toFixed(2)} / $10`;
    },
  },

  // 7. ì˜¤ë¥˜ìœ¨ ë†’ìŒ (ìµœê·¼ 10ê°œ ì¤‘ 3ê°œ ì´ìƒ)
  {
    name: "ë†’ì€ ì˜¤ë¥˜ìœ¨",
    type: "high_error_rate",
    severity: "critical",
    condition: async () => {
      const recent = await prisma.chatMetrics.findMany({
        take: 10,
        orderBy: { createdAt: "desc" },
      });
      const errorCount = recent.filter((m) => !m.success).length;
      return errorCount >= 3;
    },
    getMessage: async () => {
      const recent = await prisma.chatMetrics.findMany({
        take: 10,
        orderBy: { createdAt: "desc" },
      });
      const errorCount = recent.filter((m) => !m.success).length;
      return `ìµœê·¼ 10ê°œ ì¤‘ ${errorCount}ê°œ ì˜¤ë¥˜ ë°œìƒ`;
    },
  },
];

async function getTodayCost(): Promise<number> {
  const today = new Date();
  today.setHours(0, 0, 0, 0);

  const result = await prisma.chatMetrics.aggregate({
    where: { createdAt: { gte: today } },
    _sum: { estimatedCost: true },
  });

  return result._sum.estimatedCost || 0;
}
```

---

## 7. ë¶„ì„ ë° ë¦¬í¬íŠ¸

### 7.1 ì¼ì¼ ìš”ì•½ ìƒì„± (Cron Job)

```typescript
// src/features/ai-chat/jobs/dailySummary.ts

import { prisma } from "@/shared/lib/prisma";

/**
 * ì¼ì¼ ë©”íŠ¸ë¦­ ìš”ì•½ ìƒì„±
 * (ë§¤ì¼ ìì • ì‹¤í–‰ - Vercel Cron)
 */
export async function generateDailySummary(date: Date) {
  const dayStart = new Date(date);
  dayStart.setHours(0, 0, 0, 0);

  const dayEnd = new Date(date);
  dayEnd.setHours(23, 59, 59, 999);

  // í•´ë‹¹ ë‚ ì§œì˜ ëª¨ë“  ë©”íŠ¸ë¦­ ì¡°íšŒ
  const metrics = await prisma.chatMetrics.findMany({
    where: {
      createdAt: {
        gte: dayStart,
        lte: dayEnd,
      },
    },
  });

  if (metrics.length === 0) {
    console.log(`No metrics for ${date.toISOString().split("T")[0]}`);
    return;
  }

  // í†µê³„ ê³„ì‚°
  const totalQuestions = metrics.length;
  const simpleQuestions = metrics.filter((m) => m.complexity === "simple").length;
  const complexQuestions = metrics.filter((m) => m.complexity === "complex").length;

  const tier1Count = metrics.filter((m) => m.historyTier === 1).length;
  const tier2Count = metrics.filter((m) => m.historyTier === 2).length;
  const tier3Count = metrics.filter((m) => m.historyTier === 3).length;

  const responseTimes = metrics.map((m) => m.totalTime);
  const avgResponseTime = responseTimes.reduce((a, b) => a + b, 0) / totalQuestions;
  const minResponseTime = Math.min(...responseTimes);
  const maxResponseTime = Math.max(...responseTimes);

  const totalTokens = metrics.reduce((sum, m) => sum + m.totalTokens, 0);
  const totalCost = metrics.reduce((sum, m) => sum + m.estimatedCost, 0);
  const avgCostPerQuestion = totalCost / totalQuestions;

  const successCount = metrics.filter((m) => m.success).length;
  const successRate = (successCount / totalQuestions) * 100;
  const errorCount = totalQuestions - successCount;

  // í”¼ë“œë°±
  const withFeedback = metrics.filter((m) => m.userFeedback);
  const feedbackCount = withFeedback.length;
  const helpfulCount = withFeedback.filter(
    (m: any) => m.userFeedback?.helpful === true
  ).length;
  const satisfactionRate =
    feedbackCount > 0 ? (helpfulCount / feedbackCount) * 100 : null;

  // ìì£¼ ì‚¬ìš©ëœ ë„êµ¬
  const toolsMap = new Map<string, number>();
  metrics.forEach((m) => {
    m.toolsCalled.forEach((tool) => {
      toolsMap.set(tool, (toolsMap.get(tool) || 0) + 1);
    });
  });
  const topTools = Object.fromEntries(
    Array.from(toolsMap.entries())
      .sort((a, b) => b[1] - a[1])
      .slice(0, 10)
  );

  // ìì£¼ ë¬»ëŠ” ì§ˆë¬¸
  const questionsMap = new Map<string, number>();
  metrics.forEach((m) => {
    const normalized = m.question.toLowerCase().slice(0, 50);
    questionsMap.set(normalized, (questionsMap.get(normalized) || 0) + 1);
  });
  const topQuestions = Array.from(questionsMap.entries())
    .sort((a, b) => b[1] - a[1])
    .slice(0, 10)
    .map(([question, count]) => ({ question, count }));

  // DBì— ì €ì¥
  await prisma.dailyMetricsSummary.upsert({
    where: { date: dayStart },
    create: {
      date: dayStart,
      totalQuestions,
      simpleQuestions,
      complexQuestions,
      tier1Count,
      tier2Count,
      tier3Count,
      avgResponseTime,
      minResponseTime,
      maxResponseTime,
      totalTokens,
      totalCost,
      avgCostPerQuestion,
      successRate,
      errorCount,
      feedbackCount,
      helpfulCount,
      satisfactionRate,
      topTools,
      topQuestions,
    },
    update: {
      totalQuestions,
      simpleQuestions,
      complexQuestions,
      tier1Count,
      tier2Count,
      tier3Count,
      avgResponseTime,
      minResponseTime,
      maxResponseTime,
      totalTokens,
      totalCost,
      avgCostPerQuestion,
      successRate,
      errorCount,
      feedbackCount,
      helpfulCount,
      satisfactionRate,
      topTools,
      topQuestions,
    },
  });

  console.log(`âœ… Daily summary generated for ${date.toISOString().split("T")[0]}`);
}
```

### 7.2 Vercel Cron ì„¤ì •

```json
// vercel.json

{
  "crons": [
    {
      "path": "/api/cron/daily-summary",
      "schedule": "0 0 * * *"
    }
  ]
}
```

```typescript
// src/app/api/cron/daily-summary/route.ts

import { NextResponse } from "next/server";
import { generateDailySummary } from "@/features/ai-chat/jobs/dailySummary";

export async function GET(request: Request) {
  // Vercel Cron Secret ê²€ì¦
  const authHeader = request.headers.get("authorization");
  if (authHeader !== `Bearer ${process.env.CRON_SECRET}`) {
    return NextResponse.json({ error: "Unauthorized" }, { status: 401 });
  }

  try {
    // ì–´ì œ ë‚ ì§œ
    const yesterday = new Date();
    yesterday.setDate(yesterday.getDate() - 1);

    await generateDailySummary(yesterday);

    return NextResponse.json({ success: true });
  } catch (error) {
    console.error("Daily summary failed:", error);
    return NextResponse.json({ error: "Failed" }, { status: 500 });
  }
}
```

---

## 8. êµ¬í˜„ ìš°ì„ ìˆœìœ„

### Phase 1: ê¸°ë³¸ ëª¨ë‹ˆí„°ë§ (2ì¼) ğŸ”´ í•„ìˆ˜

```
Day 1:
[ ] Prisma ìŠ¤í‚¤ë§ˆì— ChatMetrics ëª¨ë¸ ì¶”ê°€
[ ] Migration ì‹¤í–‰
[ ] metricsCollector.ts êµ¬í˜„
[ ] tokenCounter.ts êµ¬í˜„
[ ] actions.tsì— ë©”íŠ¸ë¦­ ìˆ˜ì§‘ í†µí•©

Day 2:
[ ] ì‹¤ì‹œê°„ í†µê³„ API êµ¬í˜„
[ ] ê¸°ë³¸ ëŒ€ì‹œë³´ë“œ UI êµ¬í˜„
[ ] í…ŒìŠ¤íŠ¸ ë° ê²€ì¦
```

**ì‚°ì¶œë¬¼:**
- âœ… ëª¨ë“  AI ìƒë‹´ ë©”íŠ¸ë¦­ DB ì €ì¥
- âœ… ì‹¤ì‹œê°„ í†µê³„ ì¡°íšŒ ê°€ëŠ¥
- âœ… ê¸°ë³¸ ëŒ€ì‹œë³´ë“œ í™•ì¸ ê°€ëŠ¥

---

### Phase 2: ì•Œë¦¼ ì‹œìŠ¤í…œ (2ì¼) ğŸŸ¡ ì¤‘ìš”

```
Day 3:
[ ] MetricsAlert ëª¨ë¸ ì¶”ê°€
[ ] alertRules.ts êµ¬í˜„
[ ] ì•Œë¦¼ ì²´í¬ ë¡œì§ í†µí•©

Day 4:
[ ] ì•Œë¦¼ UI êµ¬í˜„
[ ] ì•Œë¦¼ í•´ì œ ê¸°ëŠ¥
[ ] ì´ë©”ì¼ ì•Œë¦¼ (ì„ íƒ)
```

**ì‚°ì¶œë¬¼:**
- âœ… ëŠë¦° ì‘ë‹µ ìë™ ê°ì§€
- âœ… ì˜ˆì‚° ì´ˆê³¼ ê²½ê³ 
- âœ… ì˜¤ë¥˜ìœ¨ ë†’ìŒ ê°ì§€
- âœ… ëŒ€ì‹œë³´ë“œì—ì„œ ì•Œë¦¼ í™•ì¸

---

### Phase 3: ë¶„ì„ ë° ë¦¬í¬íŠ¸ (3ì¼) ğŸŸ¢ ê³ ê¸‰

```
Day 5:
[ ] DailyMetricsSummary ëª¨ë¸ ì¶”ê°€
[ ] dailySummary.ts êµ¬í˜„
[ ] Vercel Cron ì„¤ì •

Day 6-7:
[ ] ì£¼ê°„/ì›”ê°„ ë¦¬í¬íŠ¸ API
[ ] íŠ¸ë Œë“œ ì°¨íŠ¸ UI
[ ] ë°ì´í„° ë‚´ë³´ë‚´ê¸° (CSV)
```

**ì‚°ì¶œë¬¼:**
- âœ… ì¼ì¼ ìë™ ìš”ì•½
- âœ… ì£¼ê°„/ì›”ê°„ ë¦¬í¬íŠ¸
- âœ… íŠ¸ë Œë“œ ë¶„ì„ ì°¨íŠ¸
- âœ… ë°ì´í„° ë‚´ë³´ë‚´ê¸°

---

## 9. ì˜ˆìƒ íš¨ê³¼

### 9.1 ë¹„ìš© ì ˆê°

```
ëª¨ë‹ˆí„°ë§ ë•ë¶„ì— ë°œê²¬í•  ìˆ˜ ìˆëŠ” ê²ƒë“¤:

âœ… "Tier 1ì´ 70% ì˜ˆìƒí–ˆëŠ”ë° ì‹¤ì œë¡œëŠ” 50%"
   â†’ ë¶„ë¥˜ ë¡œì§ ê°œì„  â†’ 20% ì¶”ê°€ ì ˆê°

âœ… "íŠ¹ì • ì§ˆë¬¸ì—ì„œë§Œ ì‘ë‹µ ì‹œê°„ 10ì´ˆ"
   â†’ í”„ë¡¬í”„íŠ¸ ìµœì í™” â†’ ì†ë„ 2ë°° ê°œì„ 

âœ… "AI #1ì´ ë¶ˆí•„ìš”í•œ ë„êµ¬ë¥¼ í˜¸ì¶œ ì¤‘"
   â†’ ë„êµ¬ ì‚¬ìš© ë¡œì§ ê°œì„  â†’ ë¹„ìš© 10% ì ˆê°
```

**ì˜ˆìƒ ì¶”ê°€ ì ˆê°:** 10~20%

---

### 9.2 í’ˆì§ˆ í–¥ìƒ

```
âœ… ì˜¤ë¥˜ íŒ¨í„´ íŒŒì•…
   "íŠ¹ì • ì§ˆë¬¸ í˜•ì‹ì—ì„œ ì˜¤ë¥˜ 80%"
   â†’ ì¦‰ì‹œ ìˆ˜ì • â†’ ì‹ ë¢°ë„ í–¥ìƒ

âœ… ì‚¬ìš©ì ë§Œì¡±ë„ ì¶”ì 
   "ìˆ˜ìœ  ì§ˆë¬¸ ë§Œì¡±ë„ 60%, ìˆ˜ë©´ ì§ˆë¬¸ 90%"
   â†’ ìˆ˜ìœ  ë‹µë³€ ê°œì„  â†’ ì „ì²´ ë§Œì¡±ë„ í–¥ìƒ

âœ… ë¹ ë¥¸ ë¬¸ì œ ëŒ€ì‘
   "ì‘ë‹µ ì‹œê°„ 10ì´ˆ ì´ˆê³¼ ì•Œë¦¼"
   â†’ 5ë¶„ ë‚´ ì›ì¸ íŒŒì•… ë° í•´ê²°
```

---

### 9.3 ë°ì´í„° ê¸°ë°˜ ì˜ì‚¬ê²°ì •

```
âœ… "ìˆ˜ìœ  ì§ˆë¬¸ì´ ì „ì²´ì˜ 40%"
   â†’ ìˆ˜ìœ  ì „ìš© AI ê°œë°œ ê²€í† 

âœ… "Simple ì§ˆë¬¸ì´ 18%"
   â†’ ë³µì¡ë„ ë¶„ë¥˜ ë¡œì§ ê°œì„ í•˜ì—¬ 30%ê¹Œì§€ í™•ëŒ€

âœ… "ì‚¬ìš©ì ë§Œì¡±ë„ 88%"
   â†’ íˆ¬ì ìœ ì¹˜ ìë£Œë¡œ í™œìš©
```

---

## 10. ì´ì •ë¦¬

### 10.1 êµ¬í˜„ ì²´í¬ë¦¬ìŠ¤íŠ¸

```
[ ] Phase 1: ê¸°ë³¸ ëª¨ë‹ˆí„°ë§ (2ì¼)
    [ ] ChatMetrics ëª¨ë¸
    [ ] metricsCollector ì„œë¹„ìŠ¤
    [ ] ì‹¤ì‹œê°„ í†µê³„ API
    [ ] ê¸°ë³¸ ëŒ€ì‹œë³´ë“œ

[ ] Phase 2: ì•Œë¦¼ ì‹œìŠ¤í…œ (2ì¼)
    [ ] MetricsAlert ëª¨ë¸
    [ ] ì•Œë¦¼ ê·œì¹™ êµ¬í˜„
    [ ] ì•Œë¦¼ UI

[ ] Phase 3: ë¶„ì„ ë° ë¦¬í¬íŠ¸ (3ì¼)
    [ ] DailyMetricsSummary ëª¨ë¸
    [ ] ì¼ì¼ ìš”ì•½ Cron Job
    [ ] íŠ¸ë Œë“œ ì°¨íŠ¸
    [ ] ë°ì´í„° ë‚´ë³´ë‚´ê¸°
```

**ì´ ì†Œìš” ì‹œê°„:** 7ì¼ (1ì£¼ì¼)

---

### 10.2 ì„±ê³µ ì§€í‘œ

êµ¬í˜„ ì™„ë£Œ í›„ ì¸¡ì •í•  ì§€í‘œ:

1. **ë¹„ìš© ìµœì í™” íš¨ê³¼**
   - ëª©í‘œ: 30% ë¹„ìš© ì ˆê° (ëª¨ë‹ˆí„°ë§ + ìµœì í™”)

2. **í’ˆì§ˆ í–¥ìƒ**
   - ëª©í‘œ: ì˜¤ë¥˜ìœ¨ < 1%
   - ëª©í‘œ: í‰ê·  ì‘ë‹µ ì‹œê°„ < 4ì´ˆ

3. **ì‚¬ìš©ì ë§Œì¡±ë„**
   - ëª©í‘œ: ë§Œì¡±ë„ > 85%

4. **ë¬¸ì œ ëŒ€ì‘ ì‹œê°„**
   - ëª©í‘œ: ì‹¬ê°í•œ ì˜¤ë¥˜ 5ë¶„ ë‚´ ê°ì§€

---

**ì¤€ë¹„ ì™„ë£Œ! "go" ëª…ë ¹ ì£¼ì‹œë©´ Phase 1ë¶€í„° ì‹œì‘í•˜ê² ìŠµë‹ˆë‹¤!** ğŸš€
